fileVersion: 1
id: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
name: DW_CLIENT_BENCHMARKING_POLICY_LINE
operation:
  config:
    insertStrategy: INSERT
    postSQL: |-
      BEGIN
          USE DATABASE ALLIANT_DW;

          -- Update rows if anything has changed
          UPDATE ALLIANT_DW.DBO.DW_CLIENT_BENCHMARKING_POLICY_LINE AS PL
          SET
               DW_CLIENT_ID = STG.DW_CLIENT_ID
              , DW_CLIENT_MASTER_ID = STG.DW_CLIENT_MASTER_ID
              , DW_POLICY_ID = STG.DW_POLICY_ID
              , DW_POLICY_LINE_ID = STG.DW_POLICY_LINE_ID
              , DW_STRUCTURE_ID = STG.DW_STRUCTURE_ID
              , DW_COMPANY_ID_ISSUING = STG.DW_COMPANY_ID_ISSUING
              , DW_COMPANY_ID_BILLING = STG.DW_COMPANY_ID_BILLING
              , DW_DATE_ID_EFFECTIVE_DATE = STG.DW_DATE_ID_EFFECTIVE_DATE
              , DW_DATE_ID_EXPIRATION_DATE = STG.DW_DATE_ID_EXPIRATION_DATE
              , POLICY_NUMBER = STG.POLICY_NUMBER
              , POLICY_NAME = STG.POLICY_NAME
              , POLICY_EFFECTIVE_DATE = STG.POLICY_EFFECTIVE_DATE
              , POLICY_EXPIRATION_DATE = STG.POLICY_EXPIRATION_DATE
              , POLICY_TYPE_CODE = STG.POLICY_TYPE_CODE
              , POLICY_TYPE = STG.POLICY_TYPE
              , LINE_TYPE_CODE = STG.LINE_TYPE_CODE
              , LINE_TYPE = STG.LINE_TYPE
              , AGGREGATE_LIMIT_AMOUNT = STG.AGGREGATE_LIMIT_AMOUNT
              , LIMIT_AMOUNT_PER_CLAIM = STG.LIMIT_AMOUNT_PER_CLAIM
              , EXCESS_LAYER_NUMBER = STG.EXCESS_LAYER_NUMBER
              , RETENTION_AMOUNT = STG.RETENTION_AMOUNT
              , SOURCE_SYSTEM_CLIENT_ID = STG.SOURCE_SYSTEM_CLIENT_ID
              , SOURCE_SYSTEM_POLICY_ID = STG.SOURCE_SYSTEM_POLICY_ID
              , SOURCE_SYSTEM_ORIGINAL_POLICY_ID = STG.SOURCE_SYSTEM_ORIGINAL_POLICY_ID
              , SOURCE_SYSTEM_POLICY_TYPE_ID = STG.SOURCE_SYSTEM_POLICY_TYPE_ID
              , SOURCE_SYSTEM_LINE_TYPE_ID = STG.SOURCE_SYSTEM_LINE_TYPE_ID
              , SOURCE_SYSTEM_ISSUING_COMPANY_ID = STG.SOURCE_SYSTEM_ISSUING_COMPANY_ID
              , SOURCE_SYSTEM_BILLING_COMPANY_ID = STG.SOURCE_SYSTEM_BILLING_COMPANY_ID
              , LINE_STATUS_CODE = STG.LINE_STATUS_CODE
              , BILLED_COMMISSION = STG.BILLED_COMMISSION
              , BILLED_PREMIUM = STG.BILLED_PREMIUM
              , DW_DATE_UPDATED = CURRENT_TIMESTAMP()
              , DW_UPDATE_USER = 'spdw_dw_client_benchmarking_policy_line_insertUpdate'
          FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_POLICY_LINE_STAGING') }} AS STG
          WHERE STG.SOURCE_SYSTEM_POLICY_LINE_ID = PL.SOURCE_SYSTEM_POLICY_LINE_ID
          AND 
          (
              COALESCE(STG.DW_CLIENT_ID, -1) <> COALESCE(PL.DW_CLIENT_ID, -1)
              OR COALESCE(STG.DW_CLIENT_MASTER_ID, -1) <> COALESCE(PL.DW_CLIENT_MASTER_ID, -1)
              OR COALESCE(STG.DW_POLICY_ID, -1) <> COALESCE(PL.DW_POLICY_ID, -1)
              OR COALESCE(STG.DW_POLICY_LINE_ID, -1) <> COALESCE(PL.DW_POLICY_LINE_ID, -1)
              OR COALESCE(STG.DW_STRUCTURE_ID, -1) <> COALESCE(PL.DW_STRUCTURE_ID, -1)
              OR COALESCE(STG.DW_COMPANY_ID_ISSUING, -1) <> COALESCE(PL.DW_COMPANY_ID_ISSUING, -1)
              OR COALESCE(STG.DW_COMPANY_ID_BILLING, -1) <> COALESCE(PL.DW_COMPANY_ID_BILLING, -1)
              OR COALESCE(STG.DW_DATE_ID_EFFECTIVE_DATE, -1) <> COALESCE(PL.DW_DATE_ID_EFFECTIVE_DATE, -1)
              OR COALESCE(STG.DW_DATE_ID_EXPIRATION_DATE, -1) <> COALESCE(PL.DW_DATE_ID_EXPIRATION_DATE, -1)
              OR COALESCE(STG.POLICY_NUMBER, '-1') <> COALESCE(PL.POLICY_NUMBER, '-1')
              OR COALESCE(STG.POLICY_NAME, '-1') <> COALESCE(PL.POLICY_NAME, '-1')
              OR COALESCE(STG.POLICY_EFFECTIVE_DATE, '1900-01-01'::DATE) <> COALESCE(PL.POLICY_EFFECTIVE_DATE, '1900-01-01'::DATE)
              OR COALESCE(STG.POLICY_EXPIRATION_DATE, '1900-01-01'::DATE) <> COALESCE(PL.POLICY_EXPIRATION_DATE, '1900-01-01'::DATE)
              OR COALESCE(STG.POLICY_TYPE_CODE, '-1') <> COALESCE(PL.POLICY_TYPE_CODE, '-1')
              OR COALESCE(STG.POLICY_TYPE, '-1') <> COALESCE(PL.POLICY_TYPE, '-1')
              OR COALESCE(STG.LINE_TYPE_CODE, '-1') <> COALESCE(PL.LINE_TYPE_CODE, '-1')
              OR COALESCE(STG.LINE_TYPE, '-1') <> COALESCE(PL.LINE_TYPE, '-1')
              OR COALESCE(STG.LINE_STATUS_CODE, '-1') <> COALESCE(PL.LINE_STATUS_CODE, '-1')
              OR COALESCE(STG.BILLED_COMMISSION, -1) <> COALESCE(PL.BILLED_COMMISSION, -1)
              OR COALESCE(STG.BILLED_PREMIUM, -1) <> COALESCE(PL.BILLED_PREMIUM, -1)
              OR COALESCE(STG.AGGREGATE_LIMIT_AMOUNT, '-1') <> COALESCE(PL.AGGREGATE_LIMIT_AMOUNT, '-1')
              OR COALESCE(STG.LIMIT_AMOUNT_PER_CLAIM, '-1') <> COALESCE(PL.LIMIT_AMOUNT_PER_CLAIM, '-1')
              OR COALESCE(STG.EXCESS_LAYER_NUMBER, '-1') <> COALESCE(PL.EXCESS_LAYER_NUMBER, '-1')
              OR COALESCE(STG.RETENTION_AMOUNT, '-1') <> COALESCE(PL.RETENTION_AMOUNT, '-1')
              OR COALESCE(STG.SOURCE_SYSTEM_CLIENT_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_CLIENT_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_POLICY_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_POLICY_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_ORIGINAL_POLICY_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_ORIGINAL_POLICY_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_POLICY_TYPE_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_POLICY_TYPE_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_LINE_TYPE_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_LINE_TYPE_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_ISSUING_COMPANY_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_ISSUING_COMPANY_ID, -1)
              OR COALESCE(STG.SOURCE_SYSTEM_BILLING_COMPANY_ID, -1) <> COALESCE(PL.SOURCE_SYSTEM_BILLING_COMPANY_ID, -1)
          );

          --Soft-delete if record no longer exists
          UPDATE ALLIANT_DW.DBO.DW_CLIENT_BENCHMARKING_POLICY_LINE
          SET DELETED_DATE = CURRENT_TIMESTAMP()
              , DW_DATE_UPDATED = CURRENT_TIMESTAMP()
              , DW_UPDATE_USER = 'spdw_dw_client_benchmarking_policy_line_insertUpdate'
          WHERE SOURCE_SYSTEM_POLICY_LINE_ID NOT IN (SELECT DISTINCT SOURCE_SYSTEM_POLICY_LINE_ID FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_POLICY_LINE_STAGING') }} WHERE SOURCE_SYSTEM_POLICY_LINE_ID IS NOT NULL)
          AND DELETED_DATE IS NULL;
      END;
    preSQL: ""
    testsEnabled: true
    truncateBefore: false
  database: ALLIANT_DW
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DBSHIFT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b577a641-f09f-431f-b51f-61e38ffc17e3
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DIM_POLICY_LINE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b6c31a7-e9a6-44b4-bdab-a2373079b775
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        isSystemVersion: true
        name: SYSTEM_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f39423-f2dd-4d7a-a682-1e90ef8c54c3
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isSystemCurrentFlag: true
        name: SYSTEM_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2568fef-92f5-47e1-b452-f47a61d85d7f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: SYSTEM_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca452422-4d2a-464c-b72e-360e2518e38f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: SYSTEM_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST('2999-12-31 00:00:00' AS TIMESTAMP)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 323793e2-8979-4ac9-8e43-16a70a823528
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemCreateDate: true
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f31766a0-5326-4074-8d48-de0a2024f0c4
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemUpdateDate: true
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0f2b2e53-7c39-4d37-8e6d-7422c53a233b
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7811985-3b95-46e3-a602-9907c13ac479
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_CLIENT_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3a2e316d-8a8b-4a57-b0a3-32490d1f76d4
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_CLIENT_MASTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce26a57-1282-411a-8fc8-5c4e9f7cc91e
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_CLIENT_MASTER_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 15b15b17-7429-4b13-92f7-f703e1e905c1
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b068c2d-9658-473d-bd88-12968393e9fd
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_POLICY_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b1308a09-6467-4632-9010-8f918e932375
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_POLICY_LINE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 978a3c89-2158-48b4-93dd-1215bb4ef6d9
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_POLICY_LINE_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2275753e-562a-464a-a434-6338b25cf4ac
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_STRUCTURE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c743dfca-5b65-4f32-841f-133a88c2278f
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_STRUCTURE_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 42dd551e-6169-450f-aa0e-b7a488e02d6b
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_COMPANY_ID_ISSUING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33e3b02-5e16-4148-8424-699709d02331
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_COMPANY_ID_ISSUING
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8b068e83-7c39-4d82-8c88-297c8d9e2621
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_COMPANY_ID_BILLING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 298f2402-a4e9-4e78-bc5a-4b95d98a08d2
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_COMPANY_ID_BILLING
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 541f5309-1a48-43d8-a1e6-b94f15d2a76f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_DATE_ID_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2420f592-3580-4960-ab7a-d0b89b4f4c2c
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_DATE_ID_EFFECTIVE_DATE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b577a641-f09f-431f-b51f-61e38ffc17e3
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_DATE_ID_EXPIRATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4b1b369-0a6a-49a7-a50d-b586c9f20e4d
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_DATE_ID_EXPIRATION_DATE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5b6c31a7-e9a6-44b4-bdab-a2373079b775
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLICY_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b67114b-2d5d-4f24-a212-076eb0a4f5f5
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_NUMBER
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 97f39423-f2dd-4d7a-a682-1e90ef8c54c3
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLICY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f2b2e53-7c39-4d37-8e6d-7422c53a233b
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_NAME
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a2568fef-92f5-47e1-b452-f47a61d85d7f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: POLICY_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2e316d-8a8b-4a57-b0a3-32490d1f76d4
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_EFFECTIVE_DATE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ca452422-4d2a-464c-b72e-360e2518e38f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: POLICY_EXPIRATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15b15b17-7429-4b13-92f7-f703e1e905c1
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_EXPIRATION_DATE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 323793e2-8979-4ac9-8e43-16a70a823528
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLICY_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1308a09-6467-4632-9010-8f918e932375
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_TYPE_CODE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f31766a0-5326-4074-8d48-de0a2024f0c4
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLICY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2275753e-562a-464a-a434-6338b25cf4ac
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.POLICY_TYPE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d38a7413-5683-4a1d-a02e-c5ac0c73de23
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42dd551e-6169-450f-aa0e-b7a488e02d6b
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.LINE_TYPE_CODE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 91b01c7c-47fc-4e4b-944a-e45f3c5f4943
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b068e83-7c39-4d82-8c88-297c8d9e2621
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.LINE_TYPE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2d125712-40f0-4613-81e5-1a87c125bb7c
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541f5309-1a48-43d8-a1e6-b94f15d2a76f
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.LINE_STATUS_CODE
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f28590c6-ed50-4824-ba36-cd2099ccbd63
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: DECIMAL
        defaultValue: ""
        description: ""
        name: BILLED_COMMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9124233-0b1a-4d2b-9231-318357a55e09
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.BILLED_COMMISSION
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f2c4f69e-5b1b-410a-b1cf-09f19b216441
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: DECIMAL
        defaultValue: ""
        description: ""
        name: BILLED_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e913a89-2391-4e78-a37a-42981329c3d9
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.BILLED_PREMIUM
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f7811985-3b95-46e3-a602-9907c13ac479
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: AGGREGATE_LIMIT_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f2b2e53-7c39-4d37-8e6d-7422c53a233b
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.AGGREGATE_LIMIT_AMOUNT
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cce26a57-1282-411a-8fc8-5c4e9f7cc91e
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LIMIT_AMOUNT_PER_CLAIM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2e316d-8a8b-4a57-b0a3-32490d1f76d4
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.LIMIT_AMOUNT_PER_CLAIM
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8b068c2d-9658-473d-bd88-12968393e9fd
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EXCESS_LAYER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15b15b17-7429-4b13-92f7-f703e1e905c1
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.EXCESS_LAYER_NUMBER
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 978a3c89-2158-48b4-93dd-1215bb4ef6d9
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: RETENTION_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1308a09-6467-4632-9010-8f918e932375
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.RETENTION_AMOUNT
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c743dfca-5b65-4f32-841f-133a88c2278f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2275753e-562a-464a-a434-6338b25cf4ac
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_CLIENT_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a33e3b02-5e16-4148-8424-699709d02331
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42dd551e-6169-450f-aa0e-b7a488e02d6b
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_POLICY_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 298f2402-a4e9-4e78-bc5a-4b95d98a08d2
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SOURCE_SYSTEM_POLICY_LINE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b068e83-7c39-4d82-8c88-297c8d9e2621
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_POLICY_LINE_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2420f592-3580-4960-ab7a-d0b89b4f4c2c
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_POLICY_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541f5309-1a48-43d8-a1e6-b94f15d2a76f
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_POLICY_TYPE_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f4b1b369-0a6a-49a7-a50d-b586c9f20e4d
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_LINE_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9124233-0b1a-4d2b-9231-318357a55e09
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_LINE_TYPE_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8b67114b-2d5d-4f24-a212-076eb0a4f5f5
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_ISSUING_COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e913a89-2391-4e78-a37a-42981329c3d9
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_ISSUING_COMPANY_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 97f39423-f2dd-4d7a-a682-1e90ef8c54c3
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_BILLING_COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7811985-3b95-46e3-a602-9907c13ac479
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_BILLING_COMPANY_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a2568fef-92f5-47e1-b452-f47a61d85d7f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM_ORIGINAL_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce26a57-1282-411a-8fc8-5c4e9f7cc91e
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.SOURCE_SYSTEM_ORIGINAL_POLICY_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ca452422-4d2a-464c-b72e-360e2518e38f
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DW_SOURCE_SYSTEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b068c2d-9658-473d-bd88-12968393e9fd
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_SOURCE_SYSTEM_ID
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 323793e2-8979-4ac9-8e43-16a70a823528
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP_NTZ
        defaultValue: ""
        description: ""
        name: DW_DATE_CREATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 978a3c89-2158-48b4-93dd-1215bb4ef6d9
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_DATE_CREATED
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f31766a0-5326-4074-8d48-de0a2024f0c4
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DW_CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c743dfca-5b65-4f32-841f-133a88c2278f
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_CREATE_USER
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d38a7413-5683-4a1d-a02e-c5ac0c73de23
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP_NTZ
        defaultValue: ""
        description: ""
        name: DW_DATE_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33e3b02-5e16-4148-8424-699709d02331
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_DATE_UPDATED
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 91b01c7c-47fc-4e4b-944a-e45f3c5f4943
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DW_UPDATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 298f2402-a4e9-4e78-bc5a-4b95d98a08d2
                stepCounter: 63b78298-b86f-431f-b51f-61e38ffc17e3
            transform: SRC.DW_UPDATE_USER
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2d125712-40f0-4613-81e5-1a87c125bb7c
          stepCounter: 59a35e7c-a9d8-4f8e-a9a7-937b27464166
        config: {}
        dataType: TIMESTAMP_NTZ
        defaultValue: ""
        description: ""
        name: DELETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DBSHIFT
            nodeName: STG_DW_CLIENT_BENCHMARKING_POLICY_LINE_INSERT
        join:
          joinCondition: FROM {{ ref('DBSHIFT', 'STG_DW_CLIENT_BENCHMARKING_POLICY_LINE_INSERT') }} "SRC"
        name: DW_CLIENT_BENCHMARKING_POLICY_LINE
        noLinkRefs: []
  name: DW_CLIENT_BENCHMARKING_POLICY_LINE
  overrideSQL: false
  schema: DBO
  sqlType: Dimension
  type: sql
  version: 1
type: Node